import { z } from 'zod';

import { Cve } from './cve.js';
import { File } from './file.js';

/**
 * The Malware object describes the classification of known malicious software, which is intentionally designed to cause damage to a computer, server, client, or computer network.
 *
 * OCSF Object: Malware
 */
export const Malware = z.strictObject({
  /** The malware name, as reported by the detection engine. */
  name: z.string().optional(),
  /** A unique identifier for the specific malware instance, as assigned by the detection engine (e.g., virus signature ID or IPS rule ID). */
  uid: z.string().optional(),
  /** The list of normalized identifiers of the malware classifications. */
  classification_ids: z.array(z.number().int()),
  /** The list of malware classifications, normalized to the captions of the classification_ids values. In the case of 'Other', they are defined by the event source. */
  classifications: z.array(z.string()).optional(),
  /** The list of Common Vulnerabilities and Exposures (CVE) identifiers associated with the malware. Reference: CVE */
  cves: z.array(Cve).optional(),
  /** The list of file objects representing files that were identified as infected by the malware. */
  files: z.array(File).optional(),
  /** The number of files that were identified to be infected by the malware. */
  num_infected: z.number().int().optional(),
  /** The filesystem path of the malware that was observed. */
  path: z.string().optional(),
  /** The name or identifier of the security solution or service that provided the malware detection information. */
  provider: z.string().optional(),
  /** The severity of the malware, normalized to the captions of the severity_id values. In the case of 'Other', they are defined by the event source. */
  severity: z.string().optional(),
  /** The normalized identifier of the malware severity. */
  severity_id: z.union([z.literal(0), z.literal(1), z.literal(2), z.literal(3), z.literal(4), z.literal(5), z.literal(6), z.literal(99)]).optional(),
});

export type MalwareType = z.infer<typeof Malware>;

import { z } from 'zod';

/**
 * The malware scan information object describes characteristics, metadata of a malware scanning job.
 *
 * OCSF Object: Malware Scan Info
 */
export interface MalwareScanInfoType {
  /** The administrator-supplied or application-generated name of the scan. For example: "Home office weekly user database scan", "Scan folders for viruses", "Full system virus scan" */
  name?: string;
  /** The application-defined unique identifier assigned to an instance of a scan. */
  uid?: string;
  /** The type of scan. */
  type?: string;
  /** The type id of the scan. */
  type_id: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 99;
  /** The timestamp indicating when the scan job completed execution. */
  end_time?: number;
  /** The total number of files analyzed during the scan. */
  num_files?: number;
  /** The total number of files identified as infected with malware during the scan. */
  num_infected?: number;
  /** The total number of storage volumes examined during the malware scan. */
  num_volumes?: number;
  /** The total size in bytes of all files that were scanned. */
  size?: number;
  /** The timestamp indicating when the scan job began execution. */
  start_time?: number;
  /** The number of unique malware detected across all infected files. */
  unique_malware_count?: number;
}

const MalwareScanInfoSchema = z.strictObject({
  /** The administrator-supplied or application-generated name of the scan. For example: "Home office weekly user database scan", "Scan folders for viruses", "Full system virus scan" */
  name: z.string().optional(),
  /** The application-defined unique identifier assigned to an instance of a scan. */
  uid: z.string().optional(),
  /** The type of scan. */
  type: z.string().optional(),
  /** The type id of the scan. */
  type_id: z.union([z.literal(0), z.literal(1), z.literal(2), z.literal(3), z.literal(4), z.literal(5), z.literal(6), z.literal(7), z.literal(99)]),
  /** The timestamp indicating when the scan job completed execution. */
  end_time: z.number().int().optional(),
  /** The total number of files analyzed during the scan. */
  num_files: z.number().int().optional(),
  /** The total number of files identified as infected with malware during the scan. */
  num_infected: z.number().int().optional(),
  /** The total number of storage volumes examined during the malware scan. */
  num_volumes: z.number().int().optional(),
  /** The total size in bytes of all files that were scanned. */
  size: z.number().int().optional(),
  /** The timestamp indicating when the scan job began execution. */
  start_time: z.number().int().optional(),
  /** The number of unique malware detected across all infected files. */
  unique_malware_count: z.number().int().optional(),
});

export const MalwareScanInfo = MalwareScanInfoSchema;
